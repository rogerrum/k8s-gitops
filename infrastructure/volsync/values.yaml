# VolSync backup configuration options
# Set createPVCs to false if you want to keep existing PVCs and only create backups
# Set to true to enable automatic PVC creation with restore capability
createPVCs: true  # Change to true once backups are established

# Default values for all apps (can be overridden per app)
defaults:
  pvcSuffix: config
  runAsUser: "1001"
  capacity: 1Gi
  schedule: "0 7 * * *"
  namespace: default

# Apps to backup with VolSync (based on actual PVCs in cluster)
# Per-app createPVC field overrides global createPVCs setting:
#   - createPVC: false = Never create PVC for this app (useful for existing apps during migration)
#   - createPVC: true = Always create PVC for this app (even if global is false)
#   - No createPVC field = Use global createPVCs setting
#
# Migration workflow for existing apps:
#   1. Add app with createPVC: false (backups from existing PVC)
#   2. Wait for first backup to complete
#   3. Change to createPVC: true and delete old PVC
#   4. PVC recreated with restore from backup
apps:
  # Default namespace apps
#  - app: home-assistant
#    runAsUser: "1000"
#    capacity: 10Gi
#    schedule: "0 2 * * *"
#    createPVC: false  # Don't create PVC - backup from existing PVC managed by app chart
#
#  - app: node-red
#    pvcSuffix: data
#    runAsUser: "1000"
#    capacity: 5Gi
#    schedule: "10 2 * * *"
#    createPVC: false  # Don't create PVC - backup from existing PVC managed by app chart

#  - app: frigate
#    runAsUser: "1000"
#    capacity: 10Gi
#    schedule: "20 2 * * *"

#  - app: esphome
#    capacity: 1Gi
#    schedule: "30 2 * * *"

#  - app: zigbee2mqtt
#    runAsUser: "1000"
#    capacity: 1Gi
#    schedule: "40 2 * * *"
#
#  - app: zwavejs2mqtt
#    runAsUser: "1000"
#    capacity: 1Gi
#    schedule: "50 2 * * *"

#  - app: matter-server
#    pvcSuffix: data
#    capacity: 1Gi
#    schedule: "0 3 * * *"

  - app: paperless-ngx
    pvcSuffix: data
    capacity: 5Gi
    schedule: "10 3 * * *"

#  - app: mealie
#    pvcSuffix: api-data
#    capacity: 1Gi
#    schedule: "20 3 * * *"

#  - app: planka
#    capacity: 10Gi
#    schedule: "30 3 * * *"
#
  - app: webtrees
    capacity: 1Gi
    schedule: "40 3 * * *"


  - app: manyfold
    pvcSuffix: data
    capacity: 5Gi
    schedule: "50 3 * * *"

  - app: actual
    pvcSuffix: data
    capacity: 5Gi
    schedule: "0 4 * * *"

#  - app: openttd
#    capacity: 1Gi
#    schedule: "10 4 * * *"

  - app: jellyfin
    capacity: 3Gi
    schedule: "20 4 * * *"

  - app: uptime-kuma
    pvcSuffix: data
    capacity: 5Gi
    namespace: monitoring
    schedule: "30 4 * * *"


volsync-perfectra1n:
  fullnameOverride: volsync # Required for volsync-perfectra1n fork
  image: &image
    repository: ghcr.io/perfectra1n/volsync
    tag: 0.17.6
  kopia: *image
  rclone: *image
  restic: *image
  rsync: *image
  rsync-tls: *image
  syncthing: *image
  manageCRDs: true
  metrics:
    disableAuth: true
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 1001
    runAsGroup: 1001
  nodeSelector:
    google.feature.node.kubernetes.io/coral: "true"
